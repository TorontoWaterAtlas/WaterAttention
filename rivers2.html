<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/png" href="/favicon.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Which Waters Matter? Media Attention to Toronto's Waterways</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="js/leaflet.timeline.js"></script>
  <style>
    /* Include all styles from style.css and UI blocks here */
    body { margin: 0; font-family: Arial, sans-serif; }
    #map { height: 100vh; z-index: 0; }
    #description, #info-box, #data-sources-box, #hover-box, #control {
      position: absolute;
      z-index: 1000;
      text-align: justify;
    }
    #description {
      top: 2vh; left: 3vw; padding: 10px 20px; background: #f7f7f6;
      color: #434343; border: 1px solid #99d4f2; border-radius: 15px;
      max-width: 50vw; font-size: 1em; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    #info-box {
      top: 2vh; right: 3vw; background: #f0f0f2; border: 2px solid #99d4f2;
      border-radius: 15px; padding: 10px 20px; width: 8em; height: 6em;
      display: flex; flex-direction: column; justify-content: center;
      text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .info-number { font-size: 1.5em; font-weight: bold; color: #e892a2; }
    .info-text { font-size: 1.2em; color: #99d4f2; line-height: 1.2; }
    .info-year { font-size: 1.5em; font-weight: bold; color: #e892a2; }
    #data-sources-box {
      position: absolute;
      right: 2vw;
      bottom: 20vh;
      background: #f0f0f2;
      border: 2px solid #99d4f2;
      border-radius: 15px;
      padding: 15px;
      width: 14em;
      max-height: 16em;
      font-family: Arial, sans-serif;
      box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.3);
      z-index: 1000;
    }

    .data-sources-content {
      font-size: 0.9em;
      color: #434343;
      line-height: 1.4;
      text-align: justify;
    }

    .data-sources-content a {
      color: #434343;
    }

    .data-sources-content a:hover {
      text-decoration: underline;
    }

    /* Toggle switch styles */
    .switch {
      position: relative;
      display: inline-block;
      width: 40px;
      height: 20px;
      margin: 0 8px;
      vertical-align: middle;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .switchslider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      -webkit-transition: .3s;
      transition: .3s;
      border-radius: 20px;
    }

    .switchslider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 2px;
      bottom: 2px;
      background-color: white;
      -webkit-transition: .3s;
      transition: .3s;
      border-radius: 50%;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }

    input:checked + .switchslider {
      background-color: #e892a2;
    }

    input:focus + .switchslider {
      box-shadow: 0 0 4px #e892a2;
    }

    input:checked + .switchslider:before {
      -webkit-transform: translateX(20px);
      -ms-transform: translateX(20px);
      transform: translateX(20px);
    }

    .switchslider.round {
      border-radius: 20px;
    }

    .switchslider.round:before {
      border-radius: 50%;
    }

    .data-source-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 8px;
      font-size: 0.85em;
      color: #434343;
    }

    #hover-box {
      position: absolute;
      display: none;
      background: white;
      padding: 8px 12px;
      border-radius: 6px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      font-family: sans-serif;
      font-size: 14px;
      pointer-events: none;
      z-index: 9999;
      border: 1px solid #99d4f2;
      max-width: 350px; /* Increased for news content */
      min-width: 200px;
      max-height: 200px; /* Added max height */
      overflow-y: auto; /* Allow scrolling if content is too long */
    }
    #control {
      position: absolute;
      bottom: 0; width: 100%; height: 120px; background: #f7f7f6;
      display: flex;
      align-items: center;
      justify-content: center; /* Center the group */
      padding: 0 40px; border-top: 1px solid #99d4f2;
      box-sizing: border-box;
    }

    .control-left {
            display: flex;
            flex-direction: column;
            align-items: center;
    }

    .built-for {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
    }

    .organization {
            font-size: 1.1em;
            font-weight: bold;
            color: #434343;
    }

    .control-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            max-width: none;
            width: 100%;
            justify-content: center;
    }

    .play-btn, .pause-btn {
      background: #e892a2; border: none; border-radius: 50%; width: 40px;
      height: 40px; display: flex; align-items: center; justify-content: center;
      cursor: pointer; color: white; transition: background-color 0.2s;
    }
    .play-btn:hover, .pause-btn:hover { background: #d67a94; }
    .slidecontainer {
      position: relative;
      width: 50vw; /* or 100%, or whatever width you want for the slider */
      /* min-width: 300px; */
    }
    .year-display {
      position: absolute;
      top: -25px;
      left: 0;
      font-size: 1.5em;
      font-weight: bold;
      color: #e892a2;
      pointer-events: none;
      /* The left position will be updated dynamically in JS to follow the slider thumb */
    }
    .slider {
      -webkit-appearance: none; width: 100%; height: 8px; border-radius: 5px;
      background: #d3d3d3; outline: none; opacity: 0.7; transition: opacity .2s;
    }
    .slider:hover { opacity: 1; }
    .slider::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none; width: 20px; height: 20px;
      border-radius: 50%; background: #e892a2; cursor: pointer;
    }
    .slider::-moz-range-thumb {
      width: 20px; height: 20px; border-radius: 50%; background: #e892a2; cursor: pointer; border: none;
    }
    .play-controls {
      display: flex;
      align-items: center;
      gap: 32px; /* Adjust gap as needed */
    }

    .research-credits {
            font-size: 0.9em;
            color: #434343;
            text-align: center;
            margin-top: 5px;
            line-height: 1.2;
    }

    .research-credits a {
            color: #434343;
            text-decoration: none;
    }

    .research-credits a:hover {
            text-decoration: underline;
    }


    .control-right {
            display: flex;
            flex-direction: column;
            align-items: center;
    }

    .powered-by {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
    }

    .pixi-link a {
            font-size: 1.1em;
            font-weight: bold;
            color: #434343;
            text-decoration: none;
    }

    .pixi-link a:hover {
            text-decoration: underline;
    }

  </style>
</head>
<body>
  <div id="description">
    <div style="font-weight: bold; margin-bottom: 10px; font-size: 1.1em; text-align: center;">
      Which Waters Matter? Media Attention to Toronto's Waterways (2010–2025)
    </div>
    Our map explores the uneven attention given to 15 water bodies — rivers, creeks, brooks, ponds, and water channels — across the Greater Toronto Area over a period of 15 years from 2010 to present.
    The more a water body is paid attention to in media or search engine queries, the larger it appears; other ones shrink or "disappear".
    This visual distortion is intended to provoke reflection on the disproportionate attention of different waterways, and how such disparities might shape intervention,
    leading some to be overlooked in terms of care, policy, and resource allocation. We invite you to interact with the map —
    watch the change in distortion across the map over the last 15 years, use the slider or play/pause to explore over time, or hover to learn more.
  </div>

  <div id="info-box">
    <div class="info-number" id="total-count">0</div>
    <div class="info-text">References to waterways in</div>
    <div class="info-year" id="year-label">2010</div>
  </div>

  <div id="data-sources-box">
    <div class="data-sources-content" style="font-weight: bold; margin-bottom: 10px; font-size: 1.1em; text-align: center;">
      Data Sources:
    </div>
    <div class="data-sources-content">
      Data for attention to waterways in Toronto shown in this map is sourced from <a href="https://trends.google.com" target="_blank">Google Trends</a> and <a href="https://www.thestar.com" target="_blank">Toronto Star</a> newspaper articles retrieved using <a href="https://www.proquest.com" target="_blank">ProQuest</a>. The data is indicative rather than accurate, as precision was not the goal of this visualization.
    </div>

    <div style="font-weight: bold; margin: 15px 0 8px 0; font-size: 1em; text-align: center; color: #434343;">
      Choose Data Source:
    </div>

    <div class="data-source-toggle">
      <span style="font-size: 0.9em; color: #434343;">Google Trends</span>
      <label class="switch">
        <input id="datasource-toggle" type="checkbox">
        <span class="switchslider round"></span>
      </label>
      <span style="font-size: 0.9em; color: #434343;">Toronto Star</span>
    </div>
  </div>

  <div id="hover-box"></div>

  <div id="map"></div>

  <div id="control">
    <div class="control-left">
      <div class="built-for">Map created as part of</div>
      <div class="pixi-link">
        <a href="https://torontowateratlas.github.io/" target="_blank"> The Toronto Water Atlas </a>
      </div>
    </div>

    
    <div class="control-center">
      <div class="play-controls">
	<button class="play-btn" id="play-btn">▶</button>
	<button class="pause-btn" id="pause-btn" style="display: none;">⏸</button>
	<div class="slidecontainer">
          <div class="year-display" id="currentyeartext">2010</div>
          <input type="range" min="0" max="15" value="0" class="slider" id="timeline">
	</div>
      </div>
      <div class="research-credits">
	Research and map created by Taneea S Agrawaal, Nils Bonfils, Reyna Wu, affiliated with the <a href="https://www.climateobservatory.ca/" target="_blank">Toronto Climate Observatory</a>, and Prashant Baisla
      </div>

    </div>

    <div class="control-right">
      <div class="powered-by">Powered by</div>
      <div class="pixi-link">
        <a href="https://leafletjs.com/" target="_blank">Leaflet</a> and
        <a href="https://www.flaticon.com/free-icons/contaminated-water" title="contaminated water icons">Flaticon</a>
      </div>
    </div>

  </div>

  <script src="rivers-ui.js"></script> <!-- put your updated script here -->
</body>
</html>
